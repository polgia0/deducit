)
pars<-with(as.list(pars),
c(pars,
C=pi*D,
xF=WF/MW1/(WF/MW1+(1-W0-WF)/MW2),
LF=LFw*(WF/MW1+(1-W0-WF)/MW2)
)
)
dz<-log(1:60)
z<-rev(Z*(dz[60]-dz)/dz[60])
y<-with(c(as.list(pars)),{                                 # initial conditions
c(  L=LF,                                                                #mol/s
x1=xF,                                                                   #-
Qt=0,                                                               #kcal/s
D=0,                                                                  #kg/s
D1=0)                                                                    #-
})
out<-lsodar(
y=y,
times=z,
fun=Differential_system,
rootfun=Constrains,
rtol=1e-4,
atol=rep(1e-6,length(y)),
parms=pars,
events=list(func=eventfun,root=TRUE,terminalroot=c(1,2))
)
out<-as.data.frame(out)
out<-with(as.list(pars),{
within(out,{
T<-T-273.15                                              #conversion K to C
})
})
with(c(as.list(pars)),{
print('----------------------------------',quote=F)
print(paste('Feed (kg/h)    =',format(LFw,digits=4),sep=''),quote=F)
print(paste('WF acetone     =',format(WF*100,digits=4),sep=''),quote=F)
print(paste('Rotation (rpm) =',format(nrot*60,digits=4),sep=''),quote=F)
print(paste('Temperature (C)=',format(TH,digits=4),sep=''),quote=F)
print(paste('Pressure (bar) =',format(P,digits=4),sep=''),quote=F)
print('----------------------------------',quote=F)
nr<-nrow(out)
print(out)
Tcond<-out$T[nr]
MWave<-MW1*out$x1[nr]+MW2*(1-out$x1[nr])
Lwout<-out$L[nr]*MWave+LFw*W0
ER<-(LFw-Lwout)/LFw*100
ERpb<-(LF-out$L[nr])/LF*100
Ex1<-(LF*xF-out$L[nr]*out$x1[nr])/LF/xF*100
Ex2<-(LF*(1-xF)-out$L[nr]*(1-out$x1[nr]))/LF/(1-xF)*100
Pw<-out$Qt[nr]/C/Z*4.183*10
xfin<-out$x1[nr]
Lfin<-out$L[nr]*(xfin*MW1+(1-xfin)*MW2)+LFw*W0
WFin<-out$L[nr]*xfin*MW1/Lfin*100
print(paste('Total Evaporation(%) =',format(ER,digits=4),sep=''),quote=F)
print(paste('Acetone (%)          =',format(Ex1,digit=4),sep=''),quote=F)
print(paste('Water   (%)          =',format(Ex2,digit=4),sep=''),quote=F)
print(paste('W end   (-)          =',format(WFin,digit=4),sep=''),quote=F)
print(paste('Thermal Power(kW/m2) =',format(Pw,digit=4),sep=''),quote=F)
print(paste('T cond (C)           =',format(Tcond,digit=4),sep=''),quote=F)
print('----------------------------------',quote=F)
})
shiny::runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
shiny::runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
values$rdf$right
values$selobj
values$rdf$left %in% values$selobj
values$tdf$left
values$selobj
values$tdf$left
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
gr
nlevels(gr)
pcadf()$gr
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
df
values$tdf$left
gr<-df[values$tdf$left]
gr
df
typeof(df)
typeof(values$DS)
values$DS
df<-as.data.frame(values$DS[values$rdf$left,values$vargrp])
df
gr<-df[values$tdf$left]
gr<-df[values$tdf$left,]
gr
df<-as.data.frame(values$DS[values$rdf$left,values$vargrp])
typeof(df)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
df
dim(df)
values$tdf$left
gr
dim(df)
length(values$tdf$left)
length(gr)
df
values$rdf$left
df
df<-values$DS()
df<-values$DS
df
dim(df)
values$rdf$left
row.names(df)
df<-df[values$rdf$left,]
row.names(df)
df<-values$DS[values$rdf$left,values$vargrp]
df
typeof(df)
df<-values$DS[values$rdf$left,]
typeof(df)
row.names(df)
df<-df[values$tdf$left,]
row.names(df)
gr<-df[,values$vargrp]
gr
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
shiny::runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
shiny::runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
plsobj
plsobj$coefficients
coeff<-plsobj$coefficients
coeff
input$plsslider_ncp
coeff<-coeff[,,as.numeric(input$plsslider_ncp)]
coeff
plsobj$validation$coefficients
input$yselectplscoeff
coeffcv<-plsobj$validation$coefficients[,input$yselectplscoeff,as.numeric(input$plsslider_ncp),]
dim(plsobj$validation$coefficients)
dim(plsobj$validation$coefficients[,,,])
dim(plsobj$validation$coefficients[,,,,])
input$plsslider_ncp
input$yselectplscoeff
plsobj$validation$coefficients
coeffcv<-plsobj$validation$coefficients[,,as.numeric(input$plsslider_ncp),]
dim(coeffcv)
dim(plsobj$validation$coefficients)
dim(plsobj$validation$coefficients)[2]
df<-data.frame(Name=row.names(coeff),coeff=coeff[,input$yselectplscoeff])
nseg<-dim(coeffcv)[2]
for(i in 1:nseg){df<-cbind(df,coeffcv[,i])}
runApp()
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
dim(coeff)
coeff
names(plsobj)
plsobj$model
names(plsobj)
plsobj$coefficients
dim(plsobj$coefficients)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
dim(plsobj$coefficients)
coeff[,,input$plsslider_ncp]
coeff<-coeff[,,input$plsslider_ncp]
coeff
row.names(coeff)
typeof(coeff)
names(coeff)
coeffcv<-plsobj$validation$coefficients[,,input$plsslider_ncp,]
Q
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
coeff
df<-data.frame(Name=names(coeff),coeff=coeff)
df
plsobj$validation$coefficients[,input$yselectplscoeff,as.numeric(input$plsslider_ncp),]
plsobj$validation$coefficients[,,input$plsslider_ncp,]
coeffcv
nseg
df
df<-cbind(df,coeffcv)
df
names(df)<-c("Name","coeff",paste('coeff',1:nseg,sep=''))
df
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
input$yselectplscoeff
coeff<-coeff[,input$yselectplscoeff,input$plsslider_ncp]
coeff
coeffcv<-plsobj$validation$coefficients[,input$yselectplscoeff,as.numeric(input$plsslider_ncp),]
df<-data.frame(Name=row.names(coeff),coeff=coeff)
df<-data.frame(Name=names(coeff),coeff=coeff)
df
coeffcv
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
plsobj$Yloadings[,1:as.numeric(input$plsslider_ncp)]
df<-data.frame(Q1=Q[,n1],Q2=Q[,n2])
n1<-as.numeric(input$xselectyplsqi)
n2<-as.numeric(input$yselectyplsqi)
df<-data.frame(Q1=Q[,n1],Q2=Q[,n2])
dim(q)
dim(Q)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
dim(plsobj$Yloadings)
Q<-plsobj$Yloadings[,1:as.numeric(input$plsslider_ncp)]
df<-data.frame(Q1=Q[input$xselectyplsqi],Q2=Q[input$yselectyplsqi])
Name<-names(Q)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
QM
input$xselectyplsqi
df<-data.frame(Q1=QM[as.numeric(input$xselectyplsqi)],Q2=QM[as.numeric(input$yselectyplsqi)])
Q
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
QM
data.frame(Q1=QM[as.numeric(input$xselectyplsqi)],Q2=QM[as.numeric(input$yselectyplsqi)])
plsobj$Yloadings
row.names(plsobj$Yloadings)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
plsobj$validation$PRESS[input$yselectyplspress,]
input$yselectyplspress
dim(plsobj$validation$PRESS)
plsobj$validation$PRESS
plsobj$validation$PRESS[input$yselectyplspress]
dim(plsobj$validation$PRESS)
dim(plsobj$validation$PRESS)[1]
press<-plsobj$validation$PRESS
ncomp<-plsobj$validation$ncomp
df<-data.frame(Comp=1:ncomp,Press=press)
Q
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
press<-plsobj$validation$PRESS
ncomp<-plsobj$validation$ncomp
df<-data.frame(Comp=1:ncomp,Press=press)
df
df<-data.frame(Comp=1:ncomp,Press=press)
df
press
t(press)
typeof(press)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
df
df<-data.frame(Comp=1:ncomp,Press=as.numeric(t(press)))
df
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
plsobj$Yloadings[,1:as.numeric(input$plsslider_ncp)]
as.data.frame(plsobj$projection[,1:as.numeric(input$plsslider_ncp)])
rbind(WSs,QQ)
QQ
data.frame(WQ1=WSsQ[,n1],WQ2=WSsQ[,n2], col=c(rep("Factor",nrow(WSs)),rep("Response",nrow(QQ))))
typeof(QQ)
dim(QQ)
nrows(QQ)
nrow(QQ)
nQQ<-nrow(QQ)
nQQ
is.null(nQQ)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp()
df
min(df[,c(measured,fitted)])
min(df[,c("measured","fitted")])
plt<-plt+xlim(min(df[,c("measured","fitted")]),max(df[,c("measured","fitted")]))
plt<-plt+ylim(min(df[,c("measured","fitted")]),max(df[,c("measured","fitted")]))
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
plt<-plt+xlim(min(df[,c("measured","fitted")]),max(df[,c("measured","fitted")]))
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp()
dim(mes)
mes
typeof(mes)
mes<-as.data.frame(mes)
mes[,input$yselectyplsfit]
pred[,input$yselectyplsfit]
typeof(pred)
input$plsvalidation
as.data.frame(pred[,input$yselectyplsfit])
as.data.frame(pred)[,input$yselectyplsfit]
pred<-as.data.frame(pred)
pred[,input$yselectyplsfit]
pred
input$yselectyplsfit
plsobj$validation$pred[,,as.numeric(input$plsslider_ncp)
]
mes
mes<-plsobj$model[,1]
mes
typeof(mes)
typeof(pred)
pred
runApp()
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
df
df[,c("measured","fitted")])
df[,c("measured","fitted")]
min(df[,c("measured","fitted")])
max(df[,c("measured","fitted")])
head(df)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
typeof(mes)
mes
Ymes<-as.data.frame(mes)
Ymes
pred
typeof(pred)
pred<-as.data.frame(pred)
df<-data.frame(measured=mes[,input$yselectyplsfit],fitted=pred[,input$yselectyplsfit])
df
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
Ypred
Ymes
Ypred[,input$yselectyplsfit]
ncol(Ypred)
ncol(Ymes)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
df
unlist(Ypred)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
ncol(Ypred)==1
plsobji$coefficients
dim(plsobji$coefficients)
YP<-as.matrix(XN[segi,])%*%as.matrix(plsobji$coefficients[,1,input$plsslider_ncp])
Yp
YP
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
shiny::runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
values$DS
values$DS()
isolate(values$DS())
isolate(values$DS
)
isolate(values)
input$selectexample
input$file1
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
df<-gasoline
df
dim(df)
names(df)
df<-cbinb(df$octane,df$NIR)
df<-cbind(df$octane,df$NIR)
df
names(df)
typeof(df)
df<-gasoline
typeof(df)
typeof(df[1])
typeof(df[[1])
typeof(df[[1]])
a<-gasoline
df<-data.frame(ocatane=a$octane)
df<-cbind(df,as.data.frame(a$NIR))
df
typeof(df)
names(df)
df$x
typeof(df$x)
names(df$x)
a$NIR
typeof(a$NIR)
names(a$NIR)
row.names(a$NIR)
a$NIR[1,]
attr(a$NIR)
attributes(a$NIR)
NIR<-as.data.frame(a$NIR)
attr(a$NIR,"dimnames")
attr(a$NIR,"dimnames")[1]
attr(a$NIR,"dimnames")[[1]]
attr(a$NIR,"dimnames")[[2]]
gasoline$NIR
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
names(NIR)
dim(NIR)
NIR<-data.frame(gasoline$NIR)
dim(NIR)
typeof(gasoline$NIR)
dim(gasoline$NIR)
NIR<-data.frame(as.matrix(gasoline$NIR))
dim(NIR)
NIR<-gasoline$NIR
dim(NIR)
names(NIR)<-attr(gasoline$NIR,"dimnames")[[2]]
NIR
NIR<-gasoline$NIR
NIR<-data.frame(NIR)
dim(NIR)
NIR<-data.frame(NIR)
NIR<-gasoline$NIR
dim(NIR)
typeof(NIR)
NIR<-matrix(NIR,60,401)
NIR
NIR<-data.frame(NIR)
dim(NIR)
names(NIR)<-attr(gasoline$NIR,"dimnames")[[2]]
row.names(NIR)<-attr(gasoline$NIR,"dimnames")[[1]]
df<-as.data.frame(gasoline$octane)
df
df<-as.data.frame(octane=gasoline$octane)
df<-data.frame(octane=gasoline$octane)
df
df<-cbind(df,NIR)
df
names(df)
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
attr(gasoline$NIR,"dimnames")[[2]]
gsub(attr(gasoline$NIR,"dimnames")[[2]]," ","")
gsub(" ","",attr(gasoline$NIR,"dimnames")[[2]])
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
measurevar
groupvars
paste('cbind(',paste(measurevar, collapse=","),") ~ ", paste(groupvars, collapse=" + "), sep="")
as.formula(paste('cbind(',paste(measurevar, collapse=","),") ~ ", paste(groupvars, collapse=" + "), sep=""))
gsub(" ","",attr(gasoline$NIR,"dimnames")[[2]])
paste("nir",gsub(" ","",attr(gasoline$NIR,"dimnames")[[2]]),sep='')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
oliveoil
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
shiny::runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
res
d2plotDS()$df
input$d2plot_click
d2plotDS()$df
typeof(d2plotDS()$df)
res
nearPoints(d2plotDS()$df,input$d2plot_click,"x","y",allRows=FALSE)
nearPoints(d2plotDS()$df,input$d2plot_click,allRows=FALSE)
names(d2plotDS()$df)
input$d2plot_click
input$d2plot_click/600
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
res
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
res
d2plotDS()$df
input$d2plot_click
names(input$d2plot_click)
input$d2plot_click$x
input$d2plot_click$y
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
Dres
input$d2plot_click
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp()
Dres
names(d2plot_click)
names(input$d2plot_click)
input$d2plot_click$x
input$d2plot_click$y
input$d2plot_click$mapping
input$d2plot_click$domain
names(input$d2plot_click)
input$d2plot_click$range
res
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
Dres
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
shiny::runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
runApp('C:/Users/gianm/OneDrive/Documenti/RShiny/Deducit')
